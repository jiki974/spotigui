#:import TopBarWidget spotigui.widgets.topbar.TopBarWidget
#:import TrackProgressWidget spotigui.widgets.track_progress.TrackProgressWidget

<NowPlayingScreen>:
    name: "now_playing"

    # Full-screen album art background
    FloatLayout:
        # Background image
        AsyncImage:
            id: album_art
            source: ""
            size_hint: 1, 1
            fit_mode: "cover"
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            nocache: False
            mipmap: True
            anim_delay: -1
            opacity: 0
            on_load:
                self.opacity = 1
                spinner.opacity = 0
                spinner.active = False
            on_source:
                self.opacity = 0
                spinner.opacity = 1
                spinner.active = True

        # Loading spinner
        MDLoadingIndicator:
            id: spinner
            pos_hint: {"center_x": .5, "center_y": .5}
            size_hint: None, None
            size: dp(48), dp(48)
            active: False


        # Content overlay
        MDBoxLayout:
            orientation: "vertical"

            TopBarWidget:
                id: top_bar
                font_color : "Custom"


            # Spacer to push progress bar to bottom
            Widget:

            # Progress bar section (at bottom, above navigation)
            TrackProgressWidget:
                id: track_progress

        # Modal bottom sheet for playback controls
        PlaybackControlsSheet:
            id: playback_bottom_sheet